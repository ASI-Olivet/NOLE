<!--(HTML+JavaScript): Full-page Leaflet map with ENC layers and classified point symbols -->
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- (CSS): Load Leaflet CSS map rendering -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>NOLE — Tampa Bay Map</title>

  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    /* Full-viewport map container */
    html,
    body,
    #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>
  <!-- Map container -->
  <div id="map" aria-label="Tampa Bay Map"></div>

  <!-- Load Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // Center + extended bounding box for Tampa region
    const centerStPete = [27.77, -82.64];

    const tampaBounds = L.latLngBounds(
      [26.9, -83.2],  // SW: a bit farther south & west
      [28.6, -81.9]   // NE: a bit farther north & east
    );

    // Create map, lock bounds, set zoom limits
    const map = L.map("map", {
      minZoom: 9,
      maxZoom: 18,
      maxBounds: tampaBounds,
      maxBoundsViscosity: 0.9,
    }).setView(centerStPete, 11);

    // Base layer (OpenStreetMap)
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "© OpenStreetMap contributors",
    }).addTo(map);

    // Simple scale bar
    L.control.scale({ metric: true, imperial: true }).addTo(map);

    console.log("Leaflet version:", L.version);

    // Point symbol helper based on classification
    function makePointMarker(pointClass, latlng) {
      switch (pointClass) {
        case "beacon":
          // beacon: #00FA00, small circle
          return L.circleMarker(latlng, {
            radius: 4,
            color: "#00FA00",
            weight: 1,
            fillColor: "#00FA00",
            fillOpacity: 0.9,
          });

        case "buoy":
          // buoy: #0432FF, small circle
          return L.circleMarker(latlng, {
            radius: 4,
            color: "#0432FF",
            weight: 1,
            fillColor: "#0432FF",
            fillOpacity: 0.9,
          });

        case "coastguard":
          // coastguard: #FF9300, large square
          return L.marker(latlng, {
            icon: L.divIcon({
              className: "",
              html:
                '<div style="width:16px;height:16px;background:#FF9300;"></div>',
              iconSize: [16, 16],
              iconAnchor: [8, 8],
            }),
          });

        case "fog-signal":
          // fog signal: #FFFC00, medium circle
          return L.circleMarker(latlng, {
            radius: 6,
            color: "#FFFC00",
            weight: 1,
            fillColor: "#FFFC00",
            fillOpacity: 0.9,
          });

        case "offshore-platform":
          // off shore platform: #008F00, medium square
          return L.marker(latlng, {
            icon: L.divIcon({
              className: "",
              html:
                '<div style="width:12px;height:12px;background:#008F00;"></div>',
              iconSize: [12, 12],
              iconAnchor: [6, 6],
            }),
          });

        case "wreck":
          // wreck: #FF0000, medium X
          return L.marker(latlng, {
            icon: L.divIcon({
              className: "",
              html:
                '<div style="color:#FF0000;font-size:16px;font-weight:bold;line-height:14px;">×</div>',
              iconSize: [16, 16],
              iconAnchor: [8, 7],
            }),
          });

        default:
          // Fallback: small neutral circle
          return L.circleMarker(latlng, {
            radius: 4,
            color: "#ffffff",
            weight: 1,
            fillColor: "#ffffff",
            fillOpacity: 0.7,
          });
      }
    }

    // ENC GeoJSON layers (polygons/lines + points with classification)
    const encLayers = [
      // ---- Coastal ----
      {
        name: "Coastal Bridges",
        file: "Coastal_Bridge_area_4326_clipTB.geojson",
        style: {
          color: "#ff00ff",
          weight: 2,
          fillColor: "#ff00ff",
          fillOpacity: 0.3,
        },
      },
      {
        name: "Coastal Buoy Lateral",
        file: "Coastal_Buoy_Lateral_point_4326_clipTB.geojson",
        pointClass: "buoy",
      },
      {
        name: "Coastal Buoy Safe Water",
        file: "Coastal_Buoy_Safe_Water_point_4326_clipTB.geojson",
        pointClass: "buoy",
      },
      {
        name: "Coastal Fairway (clipped)",
        file: "Coastal_Fairway_area_4326_clipTB.geojson",
        style: {
          color: "#00ff00",
          weight: 2,
          fillColor: "#00ff00",
          fillOpacity: 0.2,
        },
      },
      {
        name: "Coastal Radar Transponder Beacons",
        file: "Coastal_Radar_Transponder_Beacon_point_4326_clipTB.geojson",
        pointClass: "beacon",
      },
      {
        name: "Coastal Wrecks",
        file: "Coastal_Wreck_point_4326_clipTB.geojson",
        pointClass: "wreck",
      },

      // ---- General ----
      {
        name: "General Buoy Special Purpose",
        file: "General_Buoy_Special_Purpose_General_point_4326_clipTB.geojson",
        pointClass: "buoy",
      },
      {
        name: "General Obstructions",
        file: "General_Obstruction_area_4326_clipTB.geojson",
        style: {
          color: "#ff6600",
          weight: 2,
          fillColor: "#ff6600",
          fillOpacity: 0.25,
        },
      },

      // ---- Harbour (first batch) ----
      {
        name: "Harbour Buoy Special Purpose",
        file: "Harbour_Buoy_Special_Purpose_General_point_4326_clipTB.geojson",
        pointClass: "buoy",
      },
      {
        name: "Harbour Submarine Cables",
        file: "Harbour_Cable_Submarine_line_4326_clipTB.geojson",
        style: {
          color: "#00ffff",
          weight: 2,
        },
      },
      {
        name: "Harbour Coastguard Stations",
        file: "Harbour_Coastguard_Station_point_4326_clipTB.geojson",
        pointClass: "coastguard",
      },
      {
        name: "Harbour Coastline",
        file: "Harbour_Coastline_line_4326_clipTB.geojson",
        style: {
          color: "#ffffff",
          weight: 1,
        },
      },
      {
        name: "Harbour Fairways",
        file: "Harbour_Fairway_area_4326_clipTB.geojson",
        style: {
          color: "#0000ff",
          weight: 2,
          fillColor: "#0000ff",
          fillOpacity: 0.25,
        },
      },
      {
        name: "Harbour Fog Signals",
        file: "Harbour_Fog_Signal_point_4326_clipTB.geojson",
        pointClass: "fog-signal",
      },
      {
        name: "Harbour Marine Farms",
        file: "Harbour_Marine_Farm_Culture_area_4326_clipTB.geojson",
        style: {
          color: "#00ff88",
          weight: 2,
          fillColor: "#00ff88",
          fillOpacity: 0.3,
        },
      },
      {
        name: "Harbour Military Practice Areas",
        file: "Harbour_Military_Practice_Area_4326_clipTB.geojson",
        style: {
          color: "#ff0000",
          weight: 2,
          fillColor: "#ff0000",
          fillOpacity: 0.2,
        },
      },

      // ---- Harbour (second batch) ----
      {
        name: "Harbour Navigation Lines",
        file: "Harbour_Navigation_Line_4326_clipTB.geojson",
        style: {
          color: "#00ffff",
          weight: 2,
        },
      },
      {
        name: "Harbour Obstructions",
        file: "Harbour_Obstruction_area_4326_clipTB.geojson",
        style: {
          color: "#ff3300",
          weight: 2,
          fillColor: "#ff3300",
          fillOpacity: 0.3,
        },
      },
      {

      
